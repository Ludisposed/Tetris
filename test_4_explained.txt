part 1 of 2
some explanation on (analyzing test #4)
The total number of blocks in the rows this piece will occupy after falling down is maximized

Let's get started with some info on further actions. Each piece has 4 blocks (#). Can be several forms like __|__, '''''|__ or L. In our grid each piece's position after landing we are going to represent by number corresponding to its appearance (if it's first piece - 1, and so on)

First 6 pieces from test 4 are as follows (lising in order of appearance):
011........020........330.......040.......55555.......600
110........222........033.......444.........................666
__|''''''.... __|__...... ''''''|__...... __|__..... -------...... |____

First, second and third steps are simple to understand. We skip them and have such grid prior to 4th piece coming

0110233000
1102223300
Now let's answer what does first rule of optimal placemant means. When piece lands it occupies rows. If we land our 4th piece without any rotation at leftmost we would have this

040
444 (4th piece occupies 3rd and 4th row)
0110233000
1102223300

As we see there is no block in those rows (we do not have to count landed piece itself, cause it's always will be 4, for all situations.) Of course, above picture is somewhat stupid, we should be more optimal. So when moving our piece without rotation horizontally we found that it fits perfectly here

.......040
0110233444
1102223300

Let's count. The rows it's now occupying is 2 and 3. So total number of blocks is 5. Well, now let's rotate, and find out can we be more optimal. Remember we begin rotating clock-wise 90 degree, so our piece become
40
44 |_
40 |

We have more optimal placement. Look at this.
.......040
0110233044
1102223340

Now we occupy 3 rows (1, 2, 3). Total is 12. Nice. In tetris we will rotate (270 degree) to fit that hole better, but as rule states Among all positions with that value maximized, this position requires the least number of rotations. Thus, we take this position as the most optimal and move forward to part 2 and 5th and 6th piece placement.

We've left here. Let's bring 5th piece into the game. It's horizontal bar.

.......040
0110233044
1102223340

Without rotation the best we can do is placing on 3rd row and total will be 1.
5555.......040 (remember to put leftmost when equal situation)
0110233044
1102223340

Let's rotate. We go deeper here, and occupy rows 2 ,3, 4, 5. Total blocks on those rows are 7 (remember we are not counting 5th piece itself). So, it turned out the maximum level we can go deep with out bar is second row. As we are already at leftmost position, that means we are already in optimal place. Move on to 6th.

5
5
5......040
5110233044
1102223340

At initial pose our 6th piece can at best go 3rd row deep, and it belongs to 3rd and 4th row. That means only 3 total number of block of those rows.

5
56
5666...040
5110233044
1102223340

Let's turn this piece. Now our piece rests in rows #2, 3, 4. Thus total blocks for this position is 11. Better. Of course, if we've played tetris, we'd like to place this figure somewhere around 4th piece, to keep things tight. However, optimal place is defined to be leftmost. And in such way we keep placing our pieces.

5
5..66
5..6...040
5116233044
1102223340

if you are interested how do we get 3 rows cleared. Here are all the snapshots of those moments.

5
57766..880
5776...840
5116233844 (this row got cleared at 8th step)
1102223340

.........a
5.....9.aa
577669988a (this line cleared at 10 step)
5776..9840
1102223340

................................13
................................13.14.14
11.11...........12.......13.14......10
5..11.11.12.12..9..13..14.10.10 (this row at 14th step)
5...7...7...6..12...X...9...8...4...X
1...1...X...2...2...2...3...3...4...X
